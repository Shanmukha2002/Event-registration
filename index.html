<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Campus Connect</title>
    <!-- Use Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f0f4f8, #e2e8f0);
        }
        .event-card {
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .event-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .register-btn {
            transition: background-color 0.2s, color 0.2s;
        }
        .register-btn.registered {
            background-color: #d1d5db;
            color: #4b5563;
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- Header Section -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-4">
                    <img id="college-logo" src="Ajiet.jpg" alt="College Logo" class="h-10 w-10 md:h-12 md:w-12 rounded-full">
                    <h1 id="college-name" class="text-xl md:text-2xl font-bold text-blue-600">A J Institute of Engineering and Technology - Campus Connect</h1>
                </div>
                <nav class="hidden md:flex space-x-8">
                    <a href="#" class="text-gray-600 hover:text-blue-600 font-medium">Events</a>
                    <a href="#" class="text-gray-600 hover:text-blue-600 font-medium">Clubs</a>
                    <a href="#" class="text-gray-600 hover:text-blue-600 font-medium">Workshops</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-8 pb-16">
        <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6">
            <h2 class="text-3xl font-bold text-gray-800 mb-4 md:mb-0">Upcoming Events & Workshops</h2>
            <div class="w-full md:w-1/3">
                <input type="text" id="event-search" placeholder="Search for events..." class="w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 p-2">
            </div>
        </div>

        <!-- Events Container -->
        <div id="events-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
    </main>

    <!-- Success/Error Modal -->
    <div id="message-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center hidden">
        <div class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full mx-4">
            <h3 id="modal-title" class="text-lg font-bold mb-2"></h3>
            <p id="modal-text" class="text-gray-700 mb-4"></p>
            <button id="modal-close-btn" class="w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700">Close</button>
        </div>
    </div>

    <!-- Registration Form Modal -->
    <div id="register-modal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center hidden">
        <div class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full mx-4">
            <h3 class="text-lg font-bold mb-4">Register for Event</h3>
            <form id="register-form" class="space-y-3">
                <input type="text" id="reg-name" placeholder="Your Name" class="w-full border rounded p-2" required>
                <input type="email" id="reg-email" placeholder="Your Email" class="w-full border rounded p-2" required>
                <input type="text" id="reg-phone" placeholder="Your Phone" class="w-full border rounded p-2" required>
                <input type="hidden" id="reg-event">
                <div class="flex justify-between">
                    <button type="button" id="register-cancel" class="px-4 py-2 bg-gray-300 rounded">Cancel</button>
                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Submit</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        function showModal(title, text) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-text').textContent = text;
            document.getElementById('message-modal').classList.remove('hidden');
        }

        document.getElementById('modal-close-btn').addEventListener('click', () => {
            document.getElementById('message-modal').classList.add('hidden');
        });

        const collegeName = "A J Institute of Engineering and Technology";
        const collegeLogoUrl = "Ajiet.jpg";
        document.getElementById('college-name').textContent = `${collegeName} - Campus Connect`;
        document.getElementById('college-logo').src = collegeLogoUrl;

        const events = [
            { id: 1, title: "Annual Tech Fest", description: "A day of coding, robotics, and innovation. Don't miss the hackathon!", date: "Oct 25, 2025", location: "Auditorium A", registered: false },
            { id: 2, title: "Startup Mixer", description: "Meet founders and investors from the local startup scene. Network and get inspired.", date: "Nov 5, 2025", location: "Student Center", registered: false },
            { id: 3, title: "Cultural Night", description: "Celebrate diversity with music, dance, and food from around the world.", date: "Nov 15, 2025", location: "Main Stage", registered: false },
            { id: 4, title: "AI Workshop", description: "Learn the basics of Machine Learning and Artificial Intelligence with hands-on projects.", date: "Nov 20, 2025", location: "Lab 203", registered: false },
            { id: 5, title: "Basketball Championship", description: "Watch the final match of the season. Support your team and enjoy the game!", date: "Nov 28, 2025", location: "Sports Complex", registered: false },
            { id: 6, title: "Career Fair 2025", description: "Connect with top companies for internships and job opportunities. Bring your resume!", date: "Dec 3, 2025", location: "Gymnasium", registered: false },
        ];

        function renderEvents(eventsToRender) {
            const eventsContainer = document.getElementById('events-container');
            eventsContainer.innerHTML = '';

            if (eventsToRender.length === 0) {
                eventsContainer.innerHTML = '<p class="text-center text-gray-500 col-span-full">No events found.</p>';
                return;
            }

            eventsToRender.forEach(event => {
                const eventCard = document.createElement('div');
                eventCard.className = 'event-card bg-white p-6 rounded-lg shadow-md flex flex-col justify-between';
                eventCard.innerHTML = `
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">${event.title}</h3>
                        <p class="text-sm text-gray-600 mb-2">üóìÔ∏è ${event.date}</p>
                        <p class="text-sm text-gray-600 mb-4">üìç ${event.location}</p>
                        <p class="text-gray-700 mb-4">${event.description}</p>
                    </div>
                    <button data-id="${event.id}" class="register-btn mt-4 w-full py-2 rounded-md font-medium ${event.registered ? 'registered' : 'bg-blue-600 text-white hover:bg-blue-700'}">
                        ${event.registered ? 'Registered' : 'Register'}
                    </button>
                `;
                eventsContainer.appendChild(eventCard);
            });

            document.querySelectorAll('.register-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const eventId = parseInt(e.target.dataset.id);
                    const eventIndex = events.findIndex(event => event.id === eventId);
                    if (eventIndex !== -1) {
                        document.getElementById("reg-event").value = events[eventIndex].title;
                        document.getElementById("register-modal").classList.remove("hidden");
                    }
                });
            });
        }

        document.getElementById("register-form").addEventListener("submit", async (e) => {
            e.preventDefault();

            const name = document.getElementById("reg-name").value;
            const email = document.getElementById("reg-email").value;
            const phone = document.getElementById("reg-phone").value;
            const eventTitle = document.getElementById("reg-event").value;

            try {
                const response = await fetch("http://localhost:5000/register", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ name, email, phone, event: eventTitle })
                });

                const result = await response.json();

                if (response.ok) {
                    showModal("Registration Successful!", `You are now registered for "${eventTitle}".`);
                    const eventIndex = events.findIndex(ev => ev.title === eventTitle);
                    if (eventIndex !== -1) {
                        events[eventIndex].registered = true;
                        renderEvents(events);
                    }
                } else {
                    showModal("Error", result.error || "Something went wrong");
                }
            } catch (err) {
                showModal("Error", "Could not connect to backend");
            }

            document.getElementById("register-modal").classList.add("hidden");
            document.getElementById("register-form").reset();
        });

        document.getElementById("register-cancel").addEventListener("click", () => {
            document.getElementById("register-modal").classList.add("hidden");
        });

        document.getElementById('event-search').addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const filteredEvents = events.filter(event =>
                event.title.toLowerCase().includes(searchTerm) ||
                event.description.toLowerCase().includes(searchTerm)
            );
            renderEvents(filteredEvents);
        });

        window.onload = () => {
            renderEvents(events);
        };
    </script>
</body>
</html>
